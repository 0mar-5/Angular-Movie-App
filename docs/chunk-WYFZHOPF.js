import{Q as j,V as w,a as i,b as h,fa as b,ic as y,ja as I,jc as l,ka as D}from"./chunk-OPX47V4V.js";function M(e){let t=y(()=>e());return P(t)?new Proxy(e,{get(n,o){return o in t?(I(n[o])||Object.defineProperty(n,o,{value:l(()=>n()[o]),configurable:!0}),M(n[o])):n[o]}}):e}var E=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function P(e){if(e===null||typeof e!="object"||A(e))return!1;let t=Object.getPrototypeOf(e);if(t===Object.prototype)return!0;for(;t&&t!==Object.prototype;){if(E.includes(t.constructor))return!1;t=Object.getPrototypeOf(t)}return t===Object.prototype}function A(e){return typeof e?.[Symbol.iterator]=="function"}var J=new WeakMap,c=Symbol("STATE_SOURCE");function m(e,...t){e[c].update(n=>t.reduce((o,r)=>i(i({},o),typeof r=="function"?r(o):r),n)),H(e)}function N(e){return e[c]()}function U(e){return J.get(e[c])||[]}function H(e){let t=U(e);for(let n of t){let o=y(()=>N(e));n(o)}}function k(...e){let t=[...e],n=typeof t[0]=="function"?{}:t.shift(),o=t;return(()=>{class s{constructor(){let u=o.reduce((p,C)=>C(p),F()),{stateSignals:f,props:d,methods:K,hooks:T}=u,S=i(i(i({},f),d),K);this[c]=u[c];for(let p of Reflect.ownKeys(S))this[p]=S[p];let{onInit:W,onDestroy:L}=T;W&&W(),L&&w(b).onDestroy(L)}static \u0275fac=function(f){return new(f||s)};static \u0275prov=j({token:s,factory:s.\u0275fac,providedIn:n.providedIn||null})}return s})()}function F(){return{[c]:D({}),stateSignals:{},props:{},methods:{},hooks:{}}}function q(e){return t=>{let n=e(i(i(i({[c]:t[c]},t.stateSignals),t.props),t.methods));return Reflect.ownKeys(n),h(i({},t),{props:i(i({},t.props),n)})}}function R(e){return q(e)}function x(e){return t=>{let n=e(i(i(i({[c]:t[c]},t.stateSignals),t.props),t.methods));return Reflect.ownKeys(n),h(i({},t),{methods:i(i({},t.methods),n)})}}function O(e){return t=>{let n=typeof e=="function"?e():e,o=Reflect.ownKeys(n);t[c].update(s=>i(i({},s),n));let r=o.reduce((s,a)=>{let u=l(()=>t[c]()[a]);return h(i({},s),{[a]:M(u)})},{});return h(i({},t),{stateSignals:i(i({},t.stateSignals),r)})}}function g(){let e=JSON.parse(localStorage.getItem("userData")||"null");return JSON.parse(localStorage.getItem("users")||"[]").find(n=>n.id===e?.id)||null}function v(e){let n=JSON.parse(localStorage.getItem("users")||"[]").map(o=>o.id===e.id?e:o);localStorage.setItem("users",JSON.stringify(n)),localStorage.setItem("userData",JSON.stringify(e))}var tt=k({providedIn:"root"},O({movieWatchList:[],tvWatchList:[]}),R(e=>({combinedWatchList:l(()=>[...e.movieWatchList(),...e.tvWatchList()]),totalCombinedWatchList:l(()=>e.movieWatchList().length+e.tvWatchList().length)})),x(e=>({addToWatchList:(t,n,o)=>{t.stopPropagation();let r=g();if(!r)return null;let s=o==="movie"?"movieWatchList":"tvWatchList",a=e[s](),u=a.some(d=>d.id===n.id),f=u?a.filter(d=>d.id!==n.id):[...a,n];return m(e,{[s]:f}),r[s]=f,v(r),!u},removeFromWatchList:(t,n)=>{let o=g();if(!o)return;let r=n==="movie"?"movieWatchList":"tvWatchList",s=e[r]().filter(a=>a.id!==t);m(e,{[r]:s}),o[r]=s,v(o)},clearWatchList:()=>{let t=g();t&&(m(e,{movieWatchList:[],tvWatchList:[]}),t.movieWatchList=[],t.tvWatchList=[],v(t))},isInWatchList:(t,n)=>e[n==="movie"?"movieWatchList":"tvWatchList"]().some(r=>r.id===t),loadUserWatchList:()=>{let t=g();t&&m(e,{movieWatchList:t.movieWatchList||[],tvWatchList:t.tvWatchList||[]})}})));export{tt as a};
